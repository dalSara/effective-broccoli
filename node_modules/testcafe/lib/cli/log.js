'use strict';

exports.__esModule = true;

var _tty = require('tty');

var _tty2 = _interopRequireDefault(_tty);

var _elegantSpinner = require('elegant-spinner');

var _elegantSpinner2 = _interopRequireDefault(_elegantSpinner);

var _logUpdateAsyncHook = require('log-update-async-hook');

var _logUpdateAsyncHook2 = _interopRequireDefault(_logUpdateAsyncHook);

var _chalk = require('chalk');

var _chalk2 = _interopRequireDefault(_chalk);

var _isCi = require('is-ci');

var _isCi2 = _interopRequireDefault(_isCi);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// NOTE: To support piping, we use stderr as the log output
// stream, while stdout is used for the report output.
exports.default = {
    animation: null,
    isAnimated: _tty2.default.isatty(1) && !_isCi2.default,

    showSpinner() {
        // NOTE: we can use the spinner only if stderr is a TTY and we are not in CI environment (e.g. TravisCI),
        // otherwise we can't repaint animation frames. Thanks https://github.com/sindresorhus/ora for insight.
        if (this.isAnimated) {
            var spinnerFrame = (0, _elegantSpinner2.default)();

            this.animation = setInterval(() => {
                var frame = _chalk2.default.cyan(spinnerFrame());

                _logUpdateAsyncHook2.default.stderr(frame);
            }, 50);
        }
    },

    hideSpinner(isExit) {
        if (this.animation) {
            clearInterval(this.animation);
            _logUpdateAsyncHook2.default.stderr.clear();

            if (isExit) _logUpdateAsyncHook2.default.stderr.done();

            this.animation = null;
        }
    },

    write(text) {
        console.error(text);
    }
};
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9jbGkvbG9nLmpzIl0sIm5hbWVzIjpbImFuaW1hdGlvbiIsImlzQW5pbWF0ZWQiLCJ0dHkiLCJpc2F0dHkiLCJpc0NJIiwic2hvd1NwaW5uZXIiLCJzcGlubmVyRnJhbWUiLCJzZXRJbnRlcnZhbCIsImZyYW1lIiwiY2hhbGsiLCJjeWFuIiwibG9nVXBkYXRlIiwic3RkZXJyIiwiaGlkZVNwaW5uZXIiLCJpc0V4aXQiLCJjbGVhckludGVydmFsIiwiY2xlYXIiLCJkb25lIiwid3JpdGUiLCJ0ZXh0IiwiY29uc29sZSIsImVycm9yIl0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBRUE7QUFDQTtrQkFDZTtBQUNYQSxlQUFZLElBREQ7QUFFWEMsZ0JBQVlDLGNBQUlDLE1BQUosQ0FBVyxDQUFYLEtBQWlCLENBQUNDLGNBRm5COztBQUlYQyxrQkFBZTtBQUNYO0FBQ0E7QUFDQSxZQUFJLEtBQUtKLFVBQVQsRUFBcUI7QUFDakIsZ0JBQUlLLGVBQWUsK0JBQW5COztBQUVBLGlCQUFLTixTQUFMLEdBQWlCTyxZQUFZLE1BQU07QUFDL0Isb0JBQUlDLFFBQVFDLGdCQUFNQyxJQUFOLENBQVdKLGNBQVgsQ0FBWjs7QUFFQUssNkNBQVVDLE1BQVYsQ0FBaUJKLEtBQWpCO0FBQ0gsYUFKZ0IsRUFJZCxFQUpjLENBQWpCO0FBS0g7QUFDSixLQWhCVTs7QUFrQlhLLGdCQUFhQyxNQUFiLEVBQXFCO0FBQ2pCLFlBQUksS0FBS2QsU0FBVCxFQUFvQjtBQUNoQmUsMEJBQWMsS0FBS2YsU0FBbkI7QUFDQVcseUNBQVVDLE1BQVYsQ0FBaUJJLEtBQWpCOztBQUVBLGdCQUFJRixNQUFKLEVBQ0lILDZCQUFVQyxNQUFWLENBQWlCSyxJQUFqQjs7QUFFSixpQkFBS2pCLFNBQUwsR0FBaUIsSUFBakI7QUFDSDtBQUNKLEtBNUJVOztBQThCWGtCLFVBQU9DLElBQVAsRUFBYTtBQUNUQyxnQkFBUUMsS0FBUixDQUFjRixJQUFkO0FBQ0g7QUFoQ1UsQyIsImZpbGUiOiJjbGkvbG9nLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR0eSBmcm9tICd0dHknO1xuaW1wb3J0IGVsZWdhbnRTcGlubmVyIGZyb20gJ2VsZWdhbnQtc3Bpbm5lcic7XG5pbXBvcnQgbG9nVXBkYXRlIGZyb20gJ2xvZy11cGRhdGUtYXN5bmMtaG9vayc7XG5pbXBvcnQgY2hhbGsgZnJvbSAnY2hhbGsnO1xuaW1wb3J0IGlzQ0kgZnJvbSAnaXMtY2knO1xuXG4vLyBOT1RFOiBUbyBzdXBwb3J0IHBpcGluZywgd2UgdXNlIHN0ZGVyciBhcyB0aGUgbG9nIG91dHB1dFxuLy8gc3RyZWFtLCB3aGlsZSBzdGRvdXQgaXMgdXNlZCBmb3IgdGhlIHJlcG9ydCBvdXRwdXQuXG5leHBvcnQgZGVmYXVsdCB7XG4gICAgYW5pbWF0aW9uOiAgbnVsbCxcbiAgICBpc0FuaW1hdGVkOiB0dHkuaXNhdHR5KDEpICYmICFpc0NJLFxuXG4gICAgc2hvd1NwaW5uZXIgKCkge1xuICAgICAgICAvLyBOT1RFOiB3ZSBjYW4gdXNlIHRoZSBzcGlubmVyIG9ubHkgaWYgc3RkZXJyIGlzIGEgVFRZIGFuZCB3ZSBhcmUgbm90IGluIENJIGVudmlyb25tZW50IChlLmcuIFRyYXZpc0NJKSxcbiAgICAgICAgLy8gb3RoZXJ3aXNlIHdlIGNhbid0IHJlcGFpbnQgYW5pbWF0aW9uIGZyYW1lcy4gVGhhbmtzIGh0dHBzOi8vZ2l0aHViLmNvbS9zaW5kcmVzb3JodXMvb3JhIGZvciBpbnNpZ2h0LlxuICAgICAgICBpZiAodGhpcy5pc0FuaW1hdGVkKSB7XG4gICAgICAgICAgICB2YXIgc3Bpbm5lckZyYW1lID0gZWxlZ2FudFNwaW5uZXIoKTtcblxuICAgICAgICAgICAgdGhpcy5hbmltYXRpb24gPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFyIGZyYW1lID0gY2hhbGsuY3lhbihzcGlubmVyRnJhbWUoKSk7XG5cbiAgICAgICAgICAgICAgICBsb2dVcGRhdGUuc3RkZXJyKGZyYW1lKTtcbiAgICAgICAgICAgIH0sIDUwKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICBoaWRlU3Bpbm5lciAoaXNFeGl0KSB7XG4gICAgICAgIGlmICh0aGlzLmFuaW1hdGlvbikge1xuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLmFuaW1hdGlvbik7XG4gICAgICAgICAgICBsb2dVcGRhdGUuc3RkZXJyLmNsZWFyKCk7XG5cbiAgICAgICAgICAgIGlmIChpc0V4aXQpXG4gICAgICAgICAgICAgICAgbG9nVXBkYXRlLnN0ZGVyci5kb25lKCk7XG5cbiAgICAgICAgICAgIHRoaXMuYW5pbWF0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICB3cml0ZSAodGV4dCkge1xuICAgICAgICBjb25zb2xlLmVycm9yKHRleHQpO1xuICAgIH1cbn07XG5cbiJdfQ==
