'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _scrollingElement = require('./scrolling-element');

var _scrollingElement2 = _interopRequireDefault(_scrollingElement);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function doScrollToPosition(y) {
  var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;

  clearTimeout(window.autoScrollingTimoutId);

  var initialY = _scrollingElement2.default.scrollTop;
  var baseY = (initialY + y) * 0.5;
  var difference = initialY - baseY;
  var startTime = performance.now();

  function step() {
    var normalizedTime = Math.min((performance.now() - startTime) / duration, 1);

    window.scrollTo(0, baseY + difference * Math.cos(normalizedTime * Math.PI));

    if (normalizedTime < 1) {
      window.requestAnimationFrame(step);
    } else {
      setTimeout(function () {
        window.isAutoScrolling = false;
      }, 100);
    }
  }
  window.requestAnimationFrame(step);
}

function scrollToPosition(y) {
  var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 500;
  var delay = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;

  window.isAutoScrolling = true;

  if (delay > 0) {
    window.autoScrollingTimoutId = setTimeout(function () {
      doScrollToPosition(y, duration);
    }, delay);
  } else {
    doScrollToPosition(y, duration);
  }
}

exports.default = scrollToPosition;