'use strict';

exports.__esModule = true;

var _asyncToGenerator2 = require('babel-runtime/helpers/asyncToGenerator');

var _asyncToGenerator3 = _interopRequireDefault(_asyncToGenerator2);

var _symbol = require('babel-runtime/core-js/symbol');

var _symbol2 = _interopRequireDefault(_symbol);

var _pinkie = require('pinkie');

var _pinkie2 = _interopRequireDefault(_pinkie);

var _lodash = require('lodash');

var _promisifyEvent = require('promisify-event');

var _promisifyEvent2 = _interopRequireDefault(_promisifyEvent);

var _browserJobResult = require('../../runner/browser-job-result');

var _browserJobResult2 = _interopRequireDefault(_browserJobResult);

var _connection = require('../connection');

var _connection2 = _interopRequireDefault(_connection);

var _warningMessage = require('../../notifications/warning-message');

var _warningMessage2 = _interopRequireDefault(_warningMessage);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* global Symbol */
const name = (0, _symbol2.default)();

class BrowserProviderPluginHost {
    constructor(providerObject, providerName) {
        this.JOB_RESULT = (0, _lodash.assignIn)({}, _browserJobResult2.default);

        (0, _lodash.assignIn)(this, providerObject);

        this[name] = providerName;
    }

    // Helpers
    get providerName() {
        return this[name];
    }

    runInitScript(browserId, code) {
        var connection = _connection2.default.getById(browserId);

        return connection.runInitScript(`(${code})()`);
    }

    waitForConnectionReady(browserId) {
        var connection = _connection2.default.getById(browserId);

        if (connection.ready) return _pinkie2.default.resolve();

        return (0, _promisifyEvent2.default)(connection, 'ready');
    }

    reportWarning(browserId, ...args) {
        var connection = _connection2.default.getById(browserId);

        connection.addWarning(...args);
    }

    setUserAgentMetaInfo(browserId, message) {
        var connection = _connection2.default.getById(browserId);

        connection.setProviderMetaInfo(message);
    }

    closeLocalBrowser(browserId) {
        return (0, _asyncToGenerator3.default)(function* () {
            var connection = _connection2.default.getById(browserId);

            yield connection.provider._ensureBrowserWindowDescriptor(browserId);
            yield connection.provider._closeLocalBrowser(browserId);
        })();
    }

    resizeLocalBrowserWindow(browserId, width, height, currentWidth, currentHeight) {
        return (0, _asyncToGenerator3.default)(function* () {
            var connection = _connection2.default.getById(browserId);

            yield connection.provider._ensureBrowserWindowParameters(browserId);
            yield connection.provider._resizeLocalBrowserWindow(browserId, width, height, currentWidth, currentHeight);
        })();
    }

    // API
    // Browser control
    openBrowser() /* browserId, pageUrl, browserName */{
        return (0, _asyncToGenerator3.default)(function* () {
            throw new Error('Not implemented!');
        })();
    }

    closeBrowser() /* browserId */{
        return (0, _asyncToGenerator3.default)(function* () {
            throw new Error('Not implemented!');
        })();
    }

    // Initialization
    init() {
        return (0, _asyncToGenerator3.default)(function* () {
            return;
        })();
    }

    dispose() {
        return (0, _asyncToGenerator3.default)(function* () {
            return;
        })();
    }

    // Browser names handling
    getBrowserList() {
        return (0, _asyncToGenerator3.default)(function* () {
            throw new Error('Not implemented!');
        })();
    }

    isValidBrowserName() /* browserName */{
        return (0, _asyncToGenerator3.default)(function* () {
            return true;
        })();
    }

    // Extra functions
    isLocalBrowser() /* browserId, browserName */{
        return (0, _asyncToGenerator3.default)(function* () {
            return false;
        })();
    }

    hasCustomActionForBrowser() /* browserId */{
        var _this = this;

        return (0, _asyncToGenerator3.default)(function* () {
            return {
                hasCloseBrowser: _this.hasOwnProperty('closeBrowser'),
                hasResizeWindow: _this.hasOwnProperty('resizeWindow'),
                hasTakeScreenshot: _this.hasOwnProperty('takeScreenshot'),
                hasCanResizeWindowToDimensions: _this.hasOwnProperty('canResizeWindowToDimensions'),
                hasMaximizeWindow: _this.hasOwnProperty('maximizeWindow'),
                hasChromelessScreenshots: false
            };
        })();
    }

    resizeWindow(browserId /*, width, height, currentWidth, currentHeight */) {
        var _this2 = this;

        return (0, _asyncToGenerator3.default)(function* () {
            _this2.reportWarning(browserId, _warningMessage2.default.resizeNotSupportedByBrowserProvider, _this2[name]);
        })();
    }

    canResizeWindowToDimensions() /* browserId, width, height */{
        return (0, _asyncToGenerator3.default)(function* () {
            return true;
        })();
    }

    takeScreenshot(browserId /*, screenshotPath, pageWidth, pageHeight */) {
        var _this3 = this;

        return (0, _asyncToGenerator3.default)(function* () {
            _this3.reportWarning(browserId, _warningMessage2.default.screenshotNotSupportedByBrowserProvider, _this3[name]);
        })();
    }

    maximizeWindow(browserId) {
        var _this4 = this;

        return (0, _asyncToGenerator3.default)(function* () {
            _this4.reportWarning(browserId, _warningMessage2.default.maximizeNotSupportedByBrowserProvider, _this4[name]);
        })();
    }

    reportJobResult() /*browserId, status, data*/{
        return (0, _asyncToGenerator3.default)(function* () {
            return;
        })();
    }
}
exports.default = BrowserProviderPluginHost;
module.exports = exports['default'];
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9icm93c2VyL3Byb3ZpZGVyL3BsdWdpbi1ob3N0LmpzIl0sIm5hbWVzIjpbIm5hbWUiLCJCcm93c2VyUHJvdmlkZXJQbHVnaW5Ib3N0IiwiY29uc3RydWN0b3IiLCJwcm92aWRlck9iamVjdCIsInByb3ZpZGVyTmFtZSIsIkpPQl9SRVNVTFQiLCJCUk9XU0VSX0pPQl9SRVNVTFQiLCJydW5Jbml0U2NyaXB0IiwiYnJvd3NlcklkIiwiY29kZSIsImNvbm5lY3Rpb24iLCJCcm93c2VyQ29ubmVjdGlvbiIsImdldEJ5SWQiLCJ3YWl0Rm9yQ29ubmVjdGlvblJlYWR5IiwicmVhZHkiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlcG9ydFdhcm5pbmciLCJhcmdzIiwiYWRkV2FybmluZyIsInNldFVzZXJBZ2VudE1ldGFJbmZvIiwibWVzc2FnZSIsInNldFByb3ZpZGVyTWV0YUluZm8iLCJjbG9zZUxvY2FsQnJvd3NlciIsInByb3ZpZGVyIiwiX2Vuc3VyZUJyb3dzZXJXaW5kb3dEZXNjcmlwdG9yIiwiX2Nsb3NlTG9jYWxCcm93c2VyIiwicmVzaXplTG9jYWxCcm93c2VyV2luZG93Iiwid2lkdGgiLCJoZWlnaHQiLCJjdXJyZW50V2lkdGgiLCJjdXJyZW50SGVpZ2h0IiwiX2Vuc3VyZUJyb3dzZXJXaW5kb3dQYXJhbWV0ZXJzIiwiX3Jlc2l6ZUxvY2FsQnJvd3NlcldpbmRvdyIsIm9wZW5Ccm93c2VyIiwiRXJyb3IiLCJjbG9zZUJyb3dzZXIiLCJpbml0IiwiZGlzcG9zZSIsImdldEJyb3dzZXJMaXN0IiwiaXNWYWxpZEJyb3dzZXJOYW1lIiwiaXNMb2NhbEJyb3dzZXIiLCJoYXNDdXN0b21BY3Rpb25Gb3JCcm93c2VyIiwiaGFzQ2xvc2VCcm93c2VyIiwiaGFzT3duUHJvcGVydHkiLCJoYXNSZXNpemVXaW5kb3ciLCJoYXNUYWtlU2NyZWVuc2hvdCIsImhhc0NhblJlc2l6ZVdpbmRvd1RvRGltZW5zaW9ucyIsImhhc01heGltaXplV2luZG93IiwiaGFzQ2hyb21lbGVzc1NjcmVlbnNob3RzIiwicmVzaXplV2luZG93IiwiV0FSTklOR19NRVNTQUdFIiwicmVzaXplTm90U3VwcG9ydGVkQnlCcm93c2VyUHJvdmlkZXIiLCJjYW5SZXNpemVXaW5kb3dUb0RpbWVuc2lvbnMiLCJ0YWtlU2NyZWVuc2hvdCIsInNjcmVlbnNob3ROb3RTdXBwb3J0ZWRCeUJyb3dzZXJQcm92aWRlciIsIm1heGltaXplV2luZG93IiwibWF4aW1pemVOb3RTdXBwb3J0ZWRCeUJyb3dzZXJQcm92aWRlciIsInJlcG9ydEpvYlJlc3VsdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQ0E7Ozs7QUFDQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBTkE7QUFTQSxNQUFNQSxPQUFPLHVCQUFiOztBQUVlLE1BQU1DLHlCQUFOLENBQWdDO0FBQzNDQyxnQkFBYUMsY0FBYixFQUE2QkMsWUFBN0IsRUFBMkM7QUFDdkMsYUFBS0MsVUFBTCxHQUFrQixzQkFBUyxFQUFULEVBQWFDLDBCQUFiLENBQWxCOztBQUVBLDhCQUFTLElBQVQsRUFBZUgsY0FBZjs7QUFFQSxhQUFLSCxJQUFMLElBQWFJLFlBQWI7QUFDSDs7QUFHRDtBQUNBLFFBQUlBLFlBQUosR0FBb0I7QUFDaEIsZUFBTyxLQUFLSixJQUFMLENBQVA7QUFDSDs7QUFFRE8sa0JBQWVDLFNBQWYsRUFBMEJDLElBQTFCLEVBQWdDO0FBQzVCLFlBQUlDLGFBQWFDLHFCQUFrQkMsT0FBbEIsQ0FBMEJKLFNBQTFCLENBQWpCOztBQUVBLGVBQU9FLFdBQVdILGFBQVgsQ0FBMEIsSUFBR0UsSUFBSyxLQUFsQyxDQUFQO0FBQ0g7O0FBRURJLDJCQUF3QkwsU0FBeEIsRUFBbUM7QUFDL0IsWUFBSUUsYUFBYUMscUJBQWtCQyxPQUFsQixDQUEwQkosU0FBMUIsQ0FBakI7O0FBRUEsWUFBSUUsV0FBV0ksS0FBZixFQUNJLE9BQU9DLGlCQUFRQyxPQUFSLEVBQVA7O0FBRUosZUFBTyw4QkFBZU4sVUFBZixFQUEyQixPQUEzQixDQUFQO0FBQ0g7O0FBRURPLGtCQUFlVCxTQUFmLEVBQTBCLEdBQUdVLElBQTdCLEVBQW1DO0FBQy9CLFlBQUlSLGFBQWFDLHFCQUFrQkMsT0FBbEIsQ0FBMEJKLFNBQTFCLENBQWpCOztBQUVBRSxtQkFBV1MsVUFBWCxDQUFzQixHQUFHRCxJQUF6QjtBQUNIOztBQUVERSx5QkFBc0JaLFNBQXRCLEVBQWlDYSxPQUFqQyxFQUEwQztBQUN0QyxZQUFJWCxhQUFhQyxxQkFBa0JDLE9BQWxCLENBQTBCSixTQUExQixDQUFqQjs7QUFFQUUsbUJBQVdZLG1CQUFYLENBQStCRCxPQUEvQjtBQUNIOztBQUVLRSxxQkFBTixDQUF5QmYsU0FBekIsRUFBb0M7QUFBQTtBQUNoQyxnQkFBSUUsYUFBYUMscUJBQWtCQyxPQUFsQixDQUEwQkosU0FBMUIsQ0FBakI7O0FBRUEsa0JBQU1FLFdBQVdjLFFBQVgsQ0FBb0JDLDhCQUFwQixDQUFtRGpCLFNBQW5ELENBQU47QUFDQSxrQkFBTUUsV0FBV2MsUUFBWCxDQUFvQkUsa0JBQXBCLENBQXVDbEIsU0FBdkMsQ0FBTjtBQUpnQztBQUtuQzs7QUFFS21CLDRCQUFOLENBQWdDbkIsU0FBaEMsRUFBMkNvQixLQUEzQyxFQUFrREMsTUFBbEQsRUFBMERDLFlBQTFELEVBQXdFQyxhQUF4RSxFQUF1RjtBQUFBO0FBQ25GLGdCQUFJckIsYUFBYUMscUJBQWtCQyxPQUFsQixDQUEwQkosU0FBMUIsQ0FBakI7O0FBRUEsa0JBQU1FLFdBQVdjLFFBQVgsQ0FBb0JRLDhCQUFwQixDQUFtRHhCLFNBQW5ELENBQU47QUFDQSxrQkFBTUUsV0FBV2MsUUFBWCxDQUFvQlMseUJBQXBCLENBQThDekIsU0FBOUMsRUFBeURvQixLQUF6RCxFQUFnRUMsTUFBaEUsRUFBd0VDLFlBQXhFLEVBQXNGQyxhQUF0RixDQUFOO0FBSm1GO0FBS3RGOztBQUVEO0FBQ0E7QUFDTUcsZUFBTixHQUFtQixxQ0FBdUM7QUFBQTtBQUN0RCxrQkFBTSxJQUFJQyxLQUFKLENBQVUsa0JBQVYsQ0FBTjtBQURzRDtBQUV6RDs7QUFFS0MsZ0JBQU4sR0FBb0IsZUFBaUI7QUFBQTtBQUNqQyxrQkFBTSxJQUFJRCxLQUFKLENBQVUsa0JBQVYsQ0FBTjtBQURpQztBQUVwQzs7QUFFRDtBQUNNRSxRQUFOLEdBQWM7QUFBQTtBQUNWO0FBRFU7QUFFYjs7QUFFS0MsV0FBTixHQUFpQjtBQUFBO0FBQ2I7QUFEYTtBQUVoQjs7QUFHRDtBQUNNQyxrQkFBTixHQUF3QjtBQUFBO0FBQ3BCLGtCQUFNLElBQUlKLEtBQUosQ0FBVSxrQkFBVixDQUFOO0FBRG9CO0FBRXZCOztBQUVLSyxzQkFBTixHQUEwQixpQkFBbUI7QUFBQTtBQUN6QyxtQkFBTyxJQUFQO0FBRHlDO0FBRTVDOztBQUVEO0FBQ01DLGtCQUFOLEdBQXNCLDRCQUE4QjtBQUFBO0FBQ2hELG1CQUFPLEtBQVA7QUFEZ0Q7QUFFbkQ7O0FBRUtDLDZCQUFOLEdBQWlDLGVBQWlCO0FBQUE7O0FBQUE7QUFDOUMsbUJBQU87QUFDSEMsaUNBQWdDLE1BQUtDLGNBQUwsQ0FBb0IsY0FBcEIsQ0FEN0I7QUFFSEMsaUNBQWdDLE1BQUtELGNBQUwsQ0FBb0IsY0FBcEIsQ0FGN0I7QUFHSEUsbUNBQWdDLE1BQUtGLGNBQUwsQ0FBb0IsZ0JBQXBCLENBSDdCO0FBSUhHLGdEQUFnQyxNQUFLSCxjQUFMLENBQW9CLDZCQUFwQixDQUo3QjtBQUtISSxtQ0FBZ0MsTUFBS0osY0FBTCxDQUFvQixnQkFBcEIsQ0FMN0I7QUFNSEssMENBQWdDO0FBTjdCLGFBQVA7QUFEOEM7QUFTakQ7O0FBRUtDLGdCQUFOLENBQW9CMUMsU0FBcEIsQ0FBNkIsaURBQTdCLEVBQWdGO0FBQUE7O0FBQUE7QUFDNUUsbUJBQUtTLGFBQUwsQ0FBbUJULFNBQW5CLEVBQThCMkMseUJBQWdCQyxtQ0FBOUMsRUFBbUYsT0FBS3BELElBQUwsQ0FBbkY7QUFENEU7QUFFL0U7O0FBRUtxRCwrQkFBTixHQUFtQyw4QkFBZ0M7QUFBQTtBQUMvRCxtQkFBTyxJQUFQO0FBRCtEO0FBRWxFOztBQUVLQyxrQkFBTixDQUFzQjlDLFNBQXRCLENBQStCLDRDQUEvQixFQUE2RTtBQUFBOztBQUFBO0FBQ3pFLG1CQUFLUyxhQUFMLENBQW1CVCxTQUFuQixFQUE4QjJDLHlCQUFnQkksdUNBQTlDLEVBQXVGLE9BQUt2RCxJQUFMLENBQXZGO0FBRHlFO0FBRTVFOztBQUVLd0Qsa0JBQU4sQ0FBc0JoRCxTQUF0QixFQUFpQztBQUFBOztBQUFBO0FBQzdCLG1CQUFLUyxhQUFMLENBQW1CVCxTQUFuQixFQUE4QjJDLHlCQUFnQk0scUNBQTlDLEVBQXFGLE9BQUt6RCxJQUFMLENBQXJGO0FBRDZCO0FBRWhDOztBQUVLMEQsbUJBQU4sR0FBdUIsMkJBQTZCO0FBQUE7QUFDaEQ7QUFEZ0Q7QUFFbkQ7QUF2SDBDO2tCQUExQnpELHlCIiwiZmlsZSI6ImJyb3dzZXIvcHJvdmlkZXIvcGx1Z2luLWhvc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBnbG9iYWwgU3ltYm9sICovXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdwaW5raWUnO1xuaW1wb3J0IHsgYXNzaWduSW4gfSBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHByb21pc2lmeUV2ZW50IGZyb20gJ3Byb21pc2lmeS1ldmVudCc7XG5pbXBvcnQgQlJPV1NFUl9KT0JfUkVTVUxUIGZyb20gJy4uLy4uL3J1bm5lci9icm93c2VyLWpvYi1yZXN1bHQnO1xuaW1wb3J0IEJyb3dzZXJDb25uZWN0aW9uIGZyb20gJy4uL2Nvbm5lY3Rpb24nO1xuaW1wb3J0IFdBUk5JTkdfTUVTU0FHRSBmcm9tICcuLi8uLi9ub3RpZmljYXRpb25zL3dhcm5pbmctbWVzc2FnZSc7XG5cblxuY29uc3QgbmFtZSA9IFN5bWJvbCgpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCcm93c2VyUHJvdmlkZXJQbHVnaW5Ib3N0IHtcbiAgICBjb25zdHJ1Y3RvciAocHJvdmlkZXJPYmplY3QsIHByb3ZpZGVyTmFtZSkge1xuICAgICAgICB0aGlzLkpPQl9SRVNVTFQgPSBhc3NpZ25Jbih7fSwgQlJPV1NFUl9KT0JfUkVTVUxUKTtcblxuICAgICAgICBhc3NpZ25Jbih0aGlzLCBwcm92aWRlck9iamVjdCk7XG5cbiAgICAgICAgdGhpc1tuYW1lXSA9IHByb3ZpZGVyTmFtZTtcbiAgICB9XG5cblxuICAgIC8vIEhlbHBlcnNcbiAgICBnZXQgcHJvdmlkZXJOYW1lICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXNbbmFtZV07XG4gICAgfVxuXG4gICAgcnVuSW5pdFNjcmlwdCAoYnJvd3NlcklkLCBjb2RlKSB7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gQnJvd3NlckNvbm5lY3Rpb24uZ2V0QnlJZChicm93c2VySWQpO1xuXG4gICAgICAgIHJldHVybiBjb25uZWN0aW9uLnJ1bkluaXRTY3JpcHQoYCgke2NvZGV9KSgpYCk7XG4gICAgfVxuXG4gICAgd2FpdEZvckNvbm5lY3Rpb25SZWFkeSAoYnJvd3NlcklkKSB7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gQnJvd3NlckNvbm5lY3Rpb24uZ2V0QnlJZChicm93c2VySWQpO1xuXG4gICAgICAgIGlmIChjb25uZWN0aW9uLnJlYWR5KVxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xuXG4gICAgICAgIHJldHVybiBwcm9taXNpZnlFdmVudChjb25uZWN0aW9uLCAncmVhZHknKTtcbiAgICB9XG5cbiAgICByZXBvcnRXYXJuaW5nIChicm93c2VySWQsIC4uLmFyZ3MpIHtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBCcm93c2VyQ29ubmVjdGlvbi5nZXRCeUlkKGJyb3dzZXJJZCk7XG5cbiAgICAgICAgY29ubmVjdGlvbi5hZGRXYXJuaW5nKC4uLmFyZ3MpO1xuICAgIH1cblxuICAgIHNldFVzZXJBZ2VudE1ldGFJbmZvIChicm93c2VySWQsIG1lc3NhZ2UpIHtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBCcm93c2VyQ29ubmVjdGlvbi5nZXRCeUlkKGJyb3dzZXJJZCk7XG5cbiAgICAgICAgY29ubmVjdGlvbi5zZXRQcm92aWRlck1ldGFJbmZvKG1lc3NhZ2UpO1xuICAgIH1cblxuICAgIGFzeW5jIGNsb3NlTG9jYWxCcm93c2VyIChicm93c2VySWQpIHtcbiAgICAgICAgdmFyIGNvbm5lY3Rpb24gPSBCcm93c2VyQ29ubmVjdGlvbi5nZXRCeUlkKGJyb3dzZXJJZCk7XG5cbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5wcm92aWRlci5fZW5zdXJlQnJvd3NlcldpbmRvd0Rlc2NyaXB0b3IoYnJvd3NlcklkKTtcbiAgICAgICAgYXdhaXQgY29ubmVjdGlvbi5wcm92aWRlci5fY2xvc2VMb2NhbEJyb3dzZXIoYnJvd3NlcklkKTtcbiAgICB9XG5cbiAgICBhc3luYyByZXNpemVMb2NhbEJyb3dzZXJXaW5kb3cgKGJyb3dzZXJJZCwgd2lkdGgsIGhlaWdodCwgY3VycmVudFdpZHRoLCBjdXJyZW50SGVpZ2h0KSB7XG4gICAgICAgIHZhciBjb25uZWN0aW9uID0gQnJvd3NlckNvbm5lY3Rpb24uZ2V0QnlJZChicm93c2VySWQpO1xuXG4gICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucHJvdmlkZXIuX2Vuc3VyZUJyb3dzZXJXaW5kb3dQYXJhbWV0ZXJzKGJyb3dzZXJJZCk7XG4gICAgICAgIGF3YWl0IGNvbm5lY3Rpb24ucHJvdmlkZXIuX3Jlc2l6ZUxvY2FsQnJvd3NlcldpbmRvdyhicm93c2VySWQsIHdpZHRoLCBoZWlnaHQsIGN1cnJlbnRXaWR0aCwgY3VycmVudEhlaWdodCk7XG4gICAgfVxuXG4gICAgLy8gQVBJXG4gICAgLy8gQnJvd3NlciBjb250cm9sXG4gICAgYXN5bmMgb3BlbkJyb3dzZXIgKC8qIGJyb3dzZXJJZCwgcGFnZVVybCwgYnJvd3Nlck5hbWUgKi8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW1wbGVtZW50ZWQhJyk7XG4gICAgfVxuXG4gICAgYXN5bmMgY2xvc2VCcm93c2VyICgvKiBicm93c2VySWQgKi8pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdOb3QgaW1wbGVtZW50ZWQhJyk7XG4gICAgfVxuXG4gICAgLy8gSW5pdGlhbGl6YXRpb25cbiAgICBhc3luYyBpbml0ICgpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGFzeW5jIGRpc3Bvc2UgKCkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG5cbiAgICAvLyBCcm93c2VyIG5hbWVzIGhhbmRsaW5nXG4gICAgYXN5bmMgZ2V0QnJvd3Nlckxpc3QgKCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vdCBpbXBsZW1lbnRlZCEnKTtcbiAgICB9XG5cbiAgICBhc3luYyBpc1ZhbGlkQnJvd3Nlck5hbWUgKC8qIGJyb3dzZXJOYW1lICovKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8vIEV4dHJhIGZ1bmN0aW9uc1xuICAgIGFzeW5jIGlzTG9jYWxCcm93c2VyICgvKiBicm93c2VySWQsIGJyb3dzZXJOYW1lICovKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBhc3luYyBoYXNDdXN0b21BY3Rpb25Gb3JCcm93c2VyICgvKiBicm93c2VySWQgKi8pIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGhhc0Nsb3NlQnJvd3NlcjogICAgICAgICAgICAgICAgdGhpcy5oYXNPd25Qcm9wZXJ0eSgnY2xvc2VCcm93c2VyJyksXG4gICAgICAgICAgICBoYXNSZXNpemVXaW5kb3c6ICAgICAgICAgICAgICAgIHRoaXMuaGFzT3duUHJvcGVydHkoJ3Jlc2l6ZVdpbmRvdycpLFxuICAgICAgICAgICAgaGFzVGFrZVNjcmVlbnNob3Q6ICAgICAgICAgICAgICB0aGlzLmhhc093blByb3BlcnR5KCd0YWtlU2NyZWVuc2hvdCcpLFxuICAgICAgICAgICAgaGFzQ2FuUmVzaXplV2luZG93VG9EaW1lbnNpb25zOiB0aGlzLmhhc093blByb3BlcnR5KCdjYW5SZXNpemVXaW5kb3dUb0RpbWVuc2lvbnMnKSxcbiAgICAgICAgICAgIGhhc01heGltaXplV2luZG93OiAgICAgICAgICAgICAgdGhpcy5oYXNPd25Qcm9wZXJ0eSgnbWF4aW1pemVXaW5kb3cnKSxcbiAgICAgICAgICAgIGhhc0Nocm9tZWxlc3NTY3JlZW5zaG90czogICAgICAgZmFsc2VcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICBhc3luYyByZXNpemVXaW5kb3cgKGJyb3dzZXJJZC8qLCB3aWR0aCwgaGVpZ2h0LCBjdXJyZW50V2lkdGgsIGN1cnJlbnRIZWlnaHQgKi8pIHtcbiAgICAgICAgdGhpcy5yZXBvcnRXYXJuaW5nKGJyb3dzZXJJZCwgV0FSTklOR19NRVNTQUdFLnJlc2l6ZU5vdFN1cHBvcnRlZEJ5QnJvd3NlclByb3ZpZGVyLCB0aGlzW25hbWVdKTtcbiAgICB9XG5cbiAgICBhc3luYyBjYW5SZXNpemVXaW5kb3dUb0RpbWVuc2lvbnMgKC8qIGJyb3dzZXJJZCwgd2lkdGgsIGhlaWdodCAqLykge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBhc3luYyB0YWtlU2NyZWVuc2hvdCAoYnJvd3NlcklkLyosIHNjcmVlbnNob3RQYXRoLCBwYWdlV2lkdGgsIHBhZ2VIZWlnaHQgKi8pIHtcbiAgICAgICAgdGhpcy5yZXBvcnRXYXJuaW5nKGJyb3dzZXJJZCwgV0FSTklOR19NRVNTQUdFLnNjcmVlbnNob3ROb3RTdXBwb3J0ZWRCeUJyb3dzZXJQcm92aWRlciwgdGhpc1tuYW1lXSk7XG4gICAgfVxuXG4gICAgYXN5bmMgbWF4aW1pemVXaW5kb3cgKGJyb3dzZXJJZCkge1xuICAgICAgICB0aGlzLnJlcG9ydFdhcm5pbmcoYnJvd3NlcklkLCBXQVJOSU5HX01FU1NBR0UubWF4aW1pemVOb3RTdXBwb3J0ZWRCeUJyb3dzZXJQcm92aWRlciwgdGhpc1tuYW1lXSk7XG4gICAgfVxuXG4gICAgYXN5bmMgcmVwb3J0Sm9iUmVzdWx0ICgvKmJyb3dzZXJJZCwgc3RhdHVzLCBkYXRhKi8pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbn1cbiJdfQ==
